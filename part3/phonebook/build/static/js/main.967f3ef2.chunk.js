(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{44:function(e,n,t){"use strict";t.r(n);var r=t(20),c=t.n(r),a=t(9),o=t(11),u=t(3),i=t(2),s=t(5),l=t.n(s),d="/api/persons",b={getAll:function(){return l.a.get(d).then((function(e){return e.data}))},create:function(e){return l.a.post(d,e).then((function(e){return e.data}))},update:function(e,n){return l.a.put("".concat(d,"/").concat(e),n).then((function(e){return e.data}))},remove:function(e){return l.a.delete("".concat(d,"/").concat(e)).then((function(e){return e.data}))}},f=t(0),j=function(e){var n=e.message;if(null===n)return null;return Object(f.jsx)("div",{style:{color:"red",background:"lightgrey",fontSize:"20px",borderStyle:"solid",borderRadius:"5px",padding:"10px",marginBottom:"10px"},children:n})},m=function(e){var n=e.eventHandler;return Object(f.jsxs)("div",{children:["filter shown with ",Object(f.jsx)("input",{onChange:n})]})},h=function(e){var n=e.formEventHandler,t=e.nameEventHandler,r=e.numberEventHandler,c=e.nameValue,a=e.numberValue;return Object(f.jsxs)("form",{onSubmit:n,children:[Object(f.jsxs)("div",{children:["name: ",Object(f.jsx)("input",{value:c,onChange:t})]}),Object(f.jsxs)("div",{children:["number: ",Object(f.jsx)("input",{value:a,onChange:r})]}),Object(f.jsx)("div",{children:Object(f.jsx)("button",{type:"submit",children:"add"})})]})},p=function(e){var n=e.persons,t=e.deletePersonHandler;return Object(f.jsx)(f.Fragment,{children:n.map((function(e){return Object(f.jsxs)("div",{children:[e.name," ",e.number,Object(f.jsx)("button",{onClick:function(){return t(e.id)},children:"delete"})]},e.name)}))})},O=function(){var e=Object(i.useState)([]),n=Object(u.a)(e,2),t=n[0],r=n[1],c=Object(i.useState)(""),s=Object(u.a)(c,2),l=s[0],d=s[1],O=Object(i.useState)(""),v=Object(u.a)(O,2),x=v[0],g=v[1],w=Object(i.useState)(""),H=Object(u.a)(w,2),y=H[0],k=H[1],E=Object(i.useState)(null),S=Object(u.a)(E,2),C=S[0],T=S[1];Object(i.useEffect)((function(){b.getAll().then((function(e){return r(e)}))}),[]);return Object(f.jsxs)("div",{children:[Object(f.jsx)("h2",{children:"Phonebook"}),Object(f.jsx)(j,{message:C}),Object(f.jsx)(m,{eventHandler:function(e){return k(e.target.value)}}),Object(f.jsx)("h3",{children:"add a new"}),Object(f.jsx)(h,{formEventHandler:function(e){if(e.preventDefault(),t.map((function(e){return e.name})).includes(l)&&window.confirm("".concat(l," already exists in phonebook. Replace the existing phone number?"))){var n=t.filter((function(e){return e.name===l}))[0],c=Object(o.a)(Object(o.a)({},n),{},{number:x});b.update(n.id,c).then((function(e){var n=t.map((function(n){return n.id!==e.id?n:e}));r(n),d(""),g(""),T("Updated person ".concat(c.name," with new number: ").concat(c.number)),setTimeout((function(){T(null)}),5e3)})).catch((function(e){r(Object(a.a)(t.filter((function(e){return e.name!==n.name})))),T("Information of ".concat(n.name," has already been removed from server.")),setTimeout((function(){T(null)}),5e3)}))}else{var u=Math.max.apply(Math,Object(a.a)(t.map((function(e){return e.id}))))+1,i={name:l,number:x,id:u};b.create(i).then((function(e){r(t.concat(i)),d(""),g(""),T("Added person ".concat(i.name," with number: ").concat(i.number)),setTimeout((function(){T(null)}),5e3)})).catch((function(e){console.log(e.response.data),T(e.response.data.error),setTimeout((function(){T(null)}),5e3)}))}},nameEventHandler:function(e){return d(e.target.value)},numberEventHandler:function(e){return g(e.target.value)},nameValue:l,numberValue:x}),Object(f.jsx)("h3",{children:"Numbers"}),Object(f.jsx)(p,{persons:t.filter((function(e){return e.name.toLowerCase().includes(y.toLowerCase())})),deletePersonHandler:function(e){window.confirm("Are you sure?")?b.remove(e).then((function(n){var c=Object(a.a)(t).filter((function(n){return n.id!==e}));r(c),console.log("Deleted person with ID ".concat(e," from database."))})):(T("User cancelled deletion."),setTimeout((function(){T(null)}),5e3))}})]})};c.a.render(Object(f.jsx)(O,{}),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.967f3ef2.chunk.js.map